<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Example Forecast Workflow | NEON Ecological Forecasting Challenge</title>
  <meta name="description" content="Documentation for the NEON Ecological Forecasting Challenge" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Example Forecast Workflow | NEON Ecological Forecasting Challenge" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://seankross.com/bookdown-start/" />
  
  <meta property="og:description" content="Documentation for the NEON Ecological Forecasting Challenge" />
  <meta name="github-repo" content="eco4cast/neon4cast-docs" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Example Forecast Workflow | NEON Ecological Forecasting Challenge" />
  
  <meta name="twitter:description" content="Documentation for the NEON Ecological Forecasting Challenge" />
  

<meta name="author" content="Hosted by the Ecological Forecasting Initative Research Coordination Network and supported by National Science Foundation (DEB-1926388)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="helpful-functions.html"/>
<link rel="next" href="using-the-challenge-in-classes.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NEON Ecological Forecasting Challenge</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html"><i class="fa fa-check"></i><b>1</b> Theme: Aquatic Ecosystems</a>
<ul>
<li class="chapter" data-level="1.1" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#challenge"><i class="fa fa-check"></i><b>1.2</b> Challenge</a></li>
<li class="chapter" data-level="1.3" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#data-targets"><i class="fa fa-check"></i><b>1.3</b> Data: Targets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#surface-mean-daily-dissolved-oxygen-concentration"><i class="fa fa-check"></i><b>1.3.1</b> Surface Mean Daily Dissolved Oxygen Concentration</a></li>
<li class="chapter" data-level="1.3.2" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#surface-mean-daily-water-temperature"><i class="fa fa-check"></i><b>1.3.2</b> Surface Mean Daily Water Temperature</a></li>
<li class="chapter" data-level="1.3.3" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#chlorophyll-a"><i class="fa fa-check"></i><b>1.3.3</b> Chlorophyll-a</a></li>
<li class="chapter" data-level="1.3.4" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#focal-sites"><i class="fa fa-check"></i><b>1.3.4</b> Focal sites</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#timeline"><i class="fa fa-check"></i><b>1.4</b> Timeline</a></li>
<li class="chapter" data-level="1.5" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#observed-data-latency"><i class="fa fa-check"></i><b>1.5</b> Observed data latency</a></li>
<li class="chapter" data-level="1.6" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#submissions"><i class="fa fa-check"></i><b>1.6</b> Submissions</a></li>
<li class="chapter" data-level="1.7" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#meterological-inputs-for-modeling"><i class="fa fa-check"></i><b>1.7</b> Meterological inputs for modeling</a></li>
<li class="chapter" data-level="1.8" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#useful-functions"><i class="fa fa-check"></i><b>1.8</b> Useful functions</a></li>
<li class="chapter" data-level="1.9" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#null-models"><i class="fa fa-check"></i><b>1.9</b> Null models</a></li>
<li class="chapter" data-level="1.10" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#faq"><i class="fa fa-check"></i><b>1.10</b> FAQ</a></li>
<li class="chapter" data-level="1.11" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#design-team"><i class="fa fa-check"></i><b>1.11</b> Design Team</a></li>
<li class="chapter" data-level="1.12" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#partners"><i class="fa fa-check"></i><b>1.12</b> Partners</a></li>
<li class="chapter" data-level="1.13" data-path="theme-aquatic-ecosystems.html"><a href="theme-aquatic-ecosystems.html#references"><i class="fa fa-check"></i><b>1.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html"><i class="fa fa-check"></i><b>2</b> Theme: Carbon and Water Fluxes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#overview-1"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#challenge-1"><i class="fa fa-check"></i><b>2.2</b> Challenge</a></li>
<li class="chapter" data-level="2.3" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#data-targets-1"><i class="fa fa-check"></i><b>2.3</b> Data: Targets</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#net-ecosystem-exchange"><i class="fa fa-check"></i><b>2.3.1</b> Net ecosystem exchange</a></li>
<li class="chapter" data-level="2.3.2" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#latent-heat-flux"><i class="fa fa-check"></i><b>2.3.2</b> Latent heat flux</a></li>
<li class="chapter" data-level="2.3.3" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#focal-sites-1"><i class="fa fa-check"></i><b>2.3.3</b> Focal sites</a></li>
<li class="chapter" data-level="2.3.4" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#minute-target-data-calculation"><i class="fa fa-check"></i><b>2.3.4</b> 30-minute target data calculation</a></li>
<li class="chapter" data-level="2.3.5" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#daily-target-data-calculation"><i class="fa fa-check"></i><b>2.3.5</b> Daily target data calculation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#timeline-1"><i class="fa fa-check"></i><b>2.4</b> Timeline</a></li>
<li class="chapter" data-level="2.5" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#flux-data-latency"><i class="fa fa-check"></i><b>2.5</b> Flux data latency</a></li>
<li class="chapter" data-level="2.6" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#submissions-1"><i class="fa fa-check"></i><b>2.6</b> Submissions</a></li>
<li class="chapter" data-level="2.7" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#meterological-inputs-for-modeling-1"><i class="fa fa-check"></i><b>2.7</b> Meterological inputs for modeling</a></li>
<li class="chapter" data-level="2.8" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#null-models-1"><i class="fa fa-check"></i><b>2.8</b> Null models</a></li>
<li class="chapter" data-level="2.9" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#faq-1"><i class="fa fa-check"></i><b>2.9</b> FAQ</a></li>
<li class="chapter" data-level="2.10" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#design-team-1"><i class="fa fa-check"></i><b>2.10</b> Design team</a></li>
<li class="chapter" data-level="2.11" data-path="theme-carbon-and-water-fluxes.html"><a href="theme-carbon-and-water-fluxes.html#partners-1"><i class="fa fa-check"></i><b>2.11</b> Partners</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html"><i class="fa fa-check"></i><b>3</b> Theme: Tick Populations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#overview-2"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#challenge-2"><i class="fa fa-check"></i><b>3.2</b> Challenge</a></li>
<li class="chapter" data-level="3.3" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#data-targets-2"><i class="fa fa-check"></i><b>3.3</b> Data: Targets</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#amblyomma-americanum-nymphs"><i class="fa fa-check"></i><b>3.3.1</b> Amblyomma americanum nymphs</a></li>
<li class="chapter" data-level="3.3.2" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#focal-sites-2"><i class="fa fa-check"></i><b>3.3.2</b> Focal sites</a></li>
<li class="chapter" data-level="3.3.3" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#target-data-calculation"><i class="fa fa-check"></i><b>3.3.3</b> Target data calculation</a></li>
<li class="chapter" data-level="3.3.4" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#target-file"><i class="fa fa-check"></i><b>3.3.4</b> Target file</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#timeline-2"><i class="fa fa-check"></i><b>3.4</b> Timeline</a></li>
<li class="chapter" data-level="3.5" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#submissions-2"><i class="fa fa-check"></i><b>3.5</b> Submissions</a></li>
<li class="chapter" data-level="3.6" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#meterological-inputs-for-modeling-2"><i class="fa fa-check"></i><b>3.6</b> Meterological inputs for modeling</a></li>
<li class="chapter" data-level="3.7" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#useful-functions-1"><i class="fa fa-check"></i><b>3.7</b> Useful functions</a></li>
<li class="chapter" data-level="3.8" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#null-models-2"><i class="fa fa-check"></i><b>3.8</b> Null models</a></li>
<li class="chapter" data-level="3.9" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#faq-2"><i class="fa fa-check"></i><b>3.9</b> FAQ</a></li>
<li class="chapter" data-level="3.10" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#design-team-2"><i class="fa fa-check"></i><b>3.10</b> Design team</a></li>
<li class="chapter" data-level="3.11" data-path="theme-tick-populations.html"><a href="theme-tick-populations.html#partners-2"><i class="fa fa-check"></i><b>3.11</b> Partners</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="theme-phenology.html"><a href="theme-phenology.html"><i class="fa fa-check"></i><b>4</b> Theme: Phenology</a>
<ul>
<li class="chapter" data-level="4.1" data-path="theme-phenology.html"><a href="theme-phenology.html#overview-3"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="theme-phenology.html"><a href="theme-phenology.html#challenge-3"><i class="fa fa-check"></i><b>4.2</b> Challenge</a></li>
<li class="chapter" data-level="4.3" data-path="theme-phenology.html"><a href="theme-phenology.html#data-targets-3"><i class="fa fa-check"></i><b>4.3</b> Data: Targets</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="theme-phenology.html"><a href="theme-phenology.html#green-chromatic-coordinate-gcc"><i class="fa fa-check"></i><b>4.3.1</b> Green chromatic coordinate (gcc)</a></li>
<li class="chapter" data-level="4.3.2" data-path="theme-phenology.html"><a href="theme-phenology.html#red-chromatic-coordinate-rcc"><i class="fa fa-check"></i><b>4.3.2</b> Red chromatic coordinate (rcc)</a></li>
<li class="chapter" data-level="4.3.3" data-path="theme-phenology.html"><a href="theme-phenology.html#focal-sites-3"><i class="fa fa-check"></i><b>4.3.3</b> Focal sites</a></li>
<li class="chapter" data-level="4.3.4" data-path="theme-phenology.html"><a href="theme-phenology.html#target-data-calculation-1"><i class="fa fa-check"></i><b>4.3.4</b> Target data calculation</a></li>
<li class="chapter" data-level="4.3.5" data-path="theme-phenology.html"><a href="theme-phenology.html#target-file-1"><i class="fa fa-check"></i><b>4.3.5</b> Target file</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="theme-phenology.html"><a href="theme-phenology.html#timeline-3"><i class="fa fa-check"></i><b>4.4</b> Timeline</a></li>
<li class="chapter" data-level="4.5" data-path="theme-phenology.html"><a href="theme-phenology.html#submissions-3"><i class="fa fa-check"></i><b>4.5</b> Submissions</a></li>
<li class="chapter" data-level="4.6" data-path="theme-phenology.html"><a href="theme-phenology.html#meterological-inputs-for-modeling-3"><i class="fa fa-check"></i><b>4.6</b> Meterological inputs for modeling</a></li>
<li class="chapter" data-level="4.7" data-path="theme-phenology.html"><a href="theme-phenology.html#useful-functions-2"><i class="fa fa-check"></i><b>4.7</b> Useful functions</a></li>
<li class="chapter" data-level="4.8" data-path="theme-phenology.html"><a href="theme-phenology.html#null-models-3"><i class="fa fa-check"></i><b>4.8</b> Null models</a></li>
<li class="chapter" data-level="4.9" data-path="theme-phenology.html"><a href="theme-phenology.html#faq-3"><i class="fa fa-check"></i><b>4.9</b> FAQ</a></li>
<li class="chapter" data-level="4.10" data-path="theme-phenology.html"><a href="theme-phenology.html#design-team-3"><i class="fa fa-check"></i><b>4.10</b> Design team</a></li>
<li class="chapter" data-level="4.11" data-path="theme-phenology.html"><a href="theme-phenology.html#partners-3"><i class="fa fa-check"></i><b>4.11</b> Partners</a></li>
<li class="chapter" data-level="4.12" data-path="theme-phenology.html"><a href="theme-phenology.html#references-1"><i class="fa fa-check"></i><b>4.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html"><i class="fa fa-check"></i><b>5</b> Theme: Beetle Communities</a>
<ul>
<li class="chapter" data-level="5.1" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#overview-4"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#challenge-4"><i class="fa fa-check"></i><b>5.2</b> Challenge</a></li>
<li class="chapter" data-level="5.3" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#data-targets-4"><i class="fa fa-check"></i><b>5.3</b> Data: Targets</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#abundance-of-beetles-abundance"><i class="fa fa-check"></i><b>5.3.1</b> Abundance of beetles (abundance)</a></li>
<li class="chapter" data-level="5.3.2" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#species-richness-n"><i class="fa fa-check"></i><b>5.3.2</b> Species richness (n)</a></li>
<li class="chapter" data-level="5.3.3" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#focal-sites-4"><i class="fa fa-check"></i><b>5.3.3</b> Focal sites</a></li>
<li class="chapter" data-level="5.3.4" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#target-data-calculation-2"><i class="fa fa-check"></i><b>5.3.4</b> Target data calculation</a></li>
<li class="chapter" data-level="5.3.5" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#target-file-2"><i class="fa fa-check"></i><b>5.3.5</b> Target file</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#timeline-4"><i class="fa fa-check"></i><b>5.4</b> Timeline</a></li>
<li class="chapter" data-level="5.5" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#design-team-4"><i class="fa fa-check"></i><b>5.5</b> Design team</a></li>
<li class="chapter" data-level="5.6" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#partners-4"><i class="fa fa-check"></i><b>5.6</b> Partners</a></li>
<li class="chapter" data-level="5.7" data-path="theme-beetle-communities.html"><a href="theme-beetle-communities.html#references-2"><i class="fa fa-check"></i><b>5.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="participation.html"><a href="participation.html"><i class="fa fa-check"></i><b>6</b> Participation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="participation.html"><a href="participation.html#participation-guidance"><i class="fa fa-check"></i><b>6.1</b> Participation guidance</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="participation.html"><a href="participation.html#how-to-participate"><i class="fa fa-check"></i><b>6.1.1</b> How to participate</a></li>
<li class="chapter" data-level="6.1.2" data-path="participation.html"><a href="participation.html#teams"><i class="fa fa-check"></i><b>6.1.2</b> Teams</a></li>
<li class="chapter" data-level="6.1.3" data-path="participation.html"><a href="participation.html#slack-and-github-communication"><i class="fa fa-check"></i><b>6.1.3</b> Slack and GitHub Communication</a></li>
<li class="chapter" data-level="6.1.4" data-path="participation.html"><a href="participation.html#archiving-models"><i class="fa fa-check"></i><b>6.1.4</b> Archiving models</a></li>
<li class="chapter" data-level="6.1.5" data-path="participation.html"><a href="participation.html#computational-resources"><i class="fa fa-check"></i><b>6.1.5</b> Computational resources</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="participation.html"><a href="participation.html#participation-agreement"><i class="fa fa-check"></i><b>6.2</b> Participation agreement</a></li>
<li class="chapter" data-level="6.3" data-path="participation.html"><a href="participation.html#neon-data-use"><i class="fa fa-check"></i><b>6.3</b> NEON Data Use</a></li>
<li class="chapter" data-level="6.4" data-path="participation.html"><a href="participation.html#additional-data-options"><i class="fa fa-check"></i><b>6.4</b> Additional data options</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="submission-instructions.html"><a href="submission-instructions.html"><i class="fa fa-check"></i><b>7</b> Submission Instructions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="submission-instructions.html"><a href="submission-instructions.html#forecast-format"><i class="fa fa-check"></i><b>7.1</b> Forecast format</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="submission-instructions.html"><a href="submission-instructions.html#terrestrial-30-min"><i class="fa fa-check"></i><b>7.1.1</b> Terrestrial 30 min</a></li>
<li class="chapter" data-level="7.1.2" data-path="submission-instructions.html"><a href="submission-instructions.html#terrestrial-daily"><i class="fa fa-check"></i><b>7.1.2</b> Terrestrial Daily</a></li>
<li class="chapter" data-level="7.1.3" data-path="submission-instructions.html"><a href="submission-instructions.html#beetles"><i class="fa fa-check"></i><b>7.1.3</b> Beetles</a></li>
<li class="chapter" data-level="7.1.4" data-path="submission-instructions.html"><a href="submission-instructions.html#aquatics"><i class="fa fa-check"></i><b>7.1.4</b> Aquatics</a></li>
<li class="chapter" data-level="7.1.5" data-path="submission-instructions.html"><a href="submission-instructions.html#phenology"><i class="fa fa-check"></i><b>7.1.5</b> Phenology</a></li>
<li class="chapter" data-level="7.1.6" data-path="submission-instructions.html"><a href="submission-instructions.html#ticks"><i class="fa fa-check"></i><b>7.1.6</b> Ticks</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="submission-instructions.html"><a href="submission-instructions.html#metadata-format"><i class="fa fa-check"></i><b>7.2</b> Metadata format</a></li>
<li class="chapter" data-level="7.3" data-path="submission-instructions.html"><a href="submission-instructions.html#submission-process"><i class="fa fa-check"></i><b>7.3</b> Submission process</a></li>
<li class="chapter" data-level="7.4" data-path="submission-instructions.html"><a href="submission-instructions.html#validating-submission"><i class="fa fa-check"></i><b>7.4</b> Validating submission</a></li>
<li class="chapter" data-level="7.5" data-path="submission-instructions.html"><a href="submission-instructions.html#visualizing-submissions"><i class="fa fa-check"></i><b>7.5</b> Visualizing submissions</a></li>
<li class="chapter" data-level="7.6" data-path="submission-instructions.html"><a href="submission-instructions.html#video-describing-how-to-submit-to-the-challenge"><i class="fa fa-check"></i><b>7.6</b> Video Describing How to Submit to the Challenge</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html"><i class="fa fa-check"></i><b>8</b> Submission Metadata Generation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#team-information"><i class="fa fa-check"></i><b>8.1</b> Team information</a></li>
<li class="chapter" data-level="8.2" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#model-description"><i class="fa fa-check"></i><b>8.2</b> Model Description</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#initial-conditions"><i class="fa fa-check"></i><b>8.2.1</b> Initial conditions</a></li>
<li class="chapter" data-level="8.2.2" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#drivers"><i class="fa fa-check"></i><b>8.2.2</b> Drivers</a></li>
<li class="chapter" data-level="8.2.3" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#parameters"><i class="fa fa-check"></i><b>8.2.3</b> Parameters</a></li>
<li class="chapter" data-level="8.2.4" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#random-effects"><i class="fa fa-check"></i><b>8.2.4</b> Random effects</a></li>
<li class="chapter" data-level="8.2.5" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#process-error"><i class="fa fa-check"></i><b>8.2.5</b> Process error</a></li>
<li class="chapter" data-level="8.2.6" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#observation-error"><i class="fa fa-check"></i><b>8.2.6</b> Observation error</a></li>
<li class="chapter" data-level="8.2.7" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#progation"><i class="fa fa-check"></i><b>8.2.7</b> Progation</a></li>
<li class="chapter" data-level="8.2.8" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#assimilation"><i class="fa fa-check"></i><b>8.2.8</b> assimilation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#example-r-list"><i class="fa fa-check"></i><b>8.3</b> Example R “list”</a></li>
<li class="chapter" data-level="8.4" data-path="submission-metadata-generation.html"><a href="submission-metadata-generation.html#example"><i class="fa fa-check"></i><b>8.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>9</b> Evaluation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="evaluation.html"><a href="evaluation.html#results"><i class="fa fa-check"></i><b>9.1</b> Results</a></li>
<li class="chapter" data-level="9.2" data-path="evaluation.html"><a href="evaluation.html#scoring-metric-continuous-ranked-probability-score"><i class="fa fa-check"></i><b>9.2</b> Scoring Metric: Continuous Ranked Probability Score</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="evaluation.html"><a href="evaluation.html#example-of-a-crps-calculation-from-an-ensemble-forecast"><i class="fa fa-check"></i><b>9.2.1</b> Example of a CRPS calculation from an ensemble forecast</a></li>
<li class="chapter" data-level="9.2.2" data-path="evaluation.html"><a href="evaluation.html#exploring-the-scoring-surface"><i class="fa fa-check"></i><b>9.2.2</b> Exploring the scoring surface</a></li>
<li class="chapter" data-level="9.2.3" data-path="evaluation.html"><a href="evaluation.html#crps-from-the-normal-distribution"><i class="fa fa-check"></i><b>9.2.3</b> CRPS from the Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="evaluation.html"><a href="evaluation.html#null-forecast"><i class="fa fa-check"></i><b>9.3</b> Null forecast</a></li>
<li class="chapter" data-level="9.4" data-path="evaluation.html"><a href="evaluation.html#forecast-submission-visualization-and-leaderboard"><i class="fa fa-check"></i><b>9.4</b> Forecast Submission Visualization and Leaderboard</a></li>
<li class="chapter" data-level="9.5" data-path="evaluation.html"><a href="evaluation.html#references-3"><i class="fa fa-check"></i><b>9.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="met_inputs.html"><a href="met_inputs.html"><i class="fa fa-check"></i><b>10</b> Meteorology Inputs</a>
<ul>
<li class="chapter" data-level="10.1" data-path="met_inputs.html"><a href="met_inputs.html#noaa-global-ensemble-forecasting-system"><i class="fa fa-check"></i><b>10.1</b> NOAA Global Ensemble Forecasting System</a></li>
<li class="chapter" data-level="10.2" data-path="met_inputs.html"><a href="met_inputs.html#noaa-global-ensemble-forecasting-system-stacked"><i class="fa fa-check"></i><b>10.2</b> NOAA Global Ensemble Forecasting System Stacked</a></li>
<li class="chapter" data-level="10.3" data-path="met_inputs.html"><a href="met_inputs.html#neon-observed"><i class="fa fa-check"></i><b>10.3</b> NEON Observed</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="helpful-functions.html"><a href="helpful-functions.html"><i class="fa fa-check"></i><b>11</b> Helpful Functions</a>
<ul>
<li class="chapter" data-level="11.1" data-path="helpful-functions.html"><a href="helpful-functions.html#neon4cast-package"><i class="fa fa-check"></i><b>11.1</b> neon4cast package</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="helpful-functions.html"><a href="helpful-functions.html#installation"><i class="fa fa-check"></i><b>11.1.1</b> Installation</a></li>
<li class="chapter" data-level="11.1.2" data-path="helpful-functions.html"><a href="helpful-functions.html#example-forecast"><i class="fa fa-check"></i><b>11.1.2</b> Example forecast</a></li>
<li class="chapter" data-level="11.1.3" data-path="helpful-functions.html"><a href="helpful-functions.html#score-forecast-locally"><i class="fa fa-check"></i><b>11.1.3</b> Score forecast locally</a></li>
<li class="chapter" data-level="11.1.4" data-path="helpful-functions.html"><a href="helpful-functions.html#validate-a-forecast-file"><i class="fa fa-check"></i><b>11.1.4</b> Validate a forecast file</a></li>
<li class="chapter" data-level="11.1.5" data-path="helpful-functions.html"><a href="helpful-functions.html#generate-forecast-metadata-in-eml"><i class="fa fa-check"></i><b>11.1.5</b> Generate forecast metadata in EML</a></li>
<li class="chapter" data-level="11.1.6" data-path="helpful-functions.html"><a href="helpful-functions.html#access-efi-snapshots-of-noaa-forecasts-at-neon-sites"><i class="fa fa-check"></i><b>11.1.6</b> Access EFI snapshots of NOAA forecasts at NEON sites</a></li>
<li class="chapter" data-level="11.1.7" data-path="helpful-functions.html"><a href="helpful-functions.html#neon4cast-submit"><i class="fa fa-check"></i><b>11.1.7</b> Submit a forecast</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="helpful-functions.html"><a href="helpful-functions.html#neonstore-package"><i class="fa fa-check"></i><b>11.2</b> neonstore package</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="helpful-functions.html"><a href="helpful-functions.html#installation-1"><i class="fa fa-check"></i><b>11.2.1</b> Installation</a></li>
<li class="chapter" data-level="11.2.2" data-path="helpful-functions.html"><a href="helpful-functions.html#quickstart"><i class="fa fa-check"></i><b>11.2.2</b> Quickstart</a></li>
<li class="chapter" data-level="11.2.3" data-path="helpful-functions.html"><a href="helpful-functions.html#database-backend"><i class="fa fa-check"></i><b>11.2.3</b> Database backend</a></li>
<li class="chapter" data-level="11.2.4" data-path="helpful-functions.html"><a href="helpful-functions.html#note-on-api-limits"><i class="fa fa-check"></i><b>11.2.4</b> Note on API limits</a></li>
<li class="chapter" data-level="11.2.5" data-path="helpful-functions.html"><a href="helpful-functions.html#non-stacking-files-and-low-level-interface"><i class="fa fa-check"></i><b>11.2.5</b> Non-stacking files and low-level interface</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="helpful-functions.html"><a href="helpful-functions.html#efistandards-package"><i class="fa fa-check"></i><b>11.3</b> EFIstandards package</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="helpful-functions.html"><a href="helpful-functions.html#output-files"><i class="fa fa-check"></i><b>11.3.1</b> Output Files:</a></li>
<li class="chapter" data-level="11.3.2" data-path="helpful-functions.html"><a href="helpful-functions.html#output-metadata"><i class="fa fa-check"></i><b>11.3.2</b> Output Metadata:</a></li>
<li class="chapter" data-level="11.3.3" data-path="helpful-functions.html"><a href="helpful-functions.html#archiving"><i class="fa fa-check"></i><b>11.3.3</b> Archiving:</a></li>
<li class="chapter" data-level="11.3.4" data-path="helpful-functions.html"><a href="helpful-functions.html#vignettes"><i class="fa fa-check"></i><b>11.3.4</b> Vignettes:</a></li>
<li class="chapter" data-level="11.3.5" data-path="helpful-functions.html"><a href="helpful-functions.html#documentation"><i class="fa fa-check"></i><b>11.3.5</b> Documentation:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html"><i class="fa fa-check"></i><b>12</b> Example Forecast Workflow</a>
<ul>
<li class="chapter" data-level="12.1" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-0-set-up-r-environment-and-directories"><i class="fa fa-check"></i><b>12.1</b> Step 0: Set up R environment and directories</a></li>
<li class="chapter" data-level="12.2" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-0-define-team-name-and-team-members"><i class="fa fa-check"></i><b>12.2</b> Step 0: Define team name and team members</a></li>
<li class="chapter" data-level="12.3" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-1-download-latest-target-data-and-site-description-data"><i class="fa fa-check"></i><b>12.3</b> Step 1: Download latest target data and site description data</a></li>
<li class="chapter" data-level="12.4" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2-get-drivers"><i class="fa fa-check"></i><b>12.4</b> Step 2: Get drivers</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2.1-download-paste-noaa-forecast-stacked-together"><i class="fa fa-check"></i><b>12.4.1</b> Step 2.1: Download Paste NOAA forecast stacked together</a></li>
<li class="chapter" data-level="12.4.2" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2.2-download-noaa-future-forecast"><i class="fa fa-check"></i><b>12.4.2</b> Step 2.2: Download NOAA future forecast</a></li>
<li class="chapter" data-level="12.4.3" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2.3-create-data-frames-of-drivers"><i class="fa fa-check"></i><b>12.4.3</b> Step 2.3 Create data frames of drivers</a></li>
<li class="chapter" data-level="12.4.4" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2.4-aggregate-to-day-and-convert-units-of-drivers"><i class="fa fa-check"></i><b>12.4.4</b> Step 2.4 Aggregate (to day) and convert units of drivers</a></li>
<li class="chapter" data-level="12.4.5" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-2.5-merge-in-past-noaa-data-into-the-targets-file-matching-by-date."><i class="fa fa-check"></i><b>12.4.5</b> Step 2.5: Merge in past NOAA data into the targets file, matching by date.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-3.0-generate-forecasts-for-each-site"><i class="fa fa-check"></i><b>12.5</b> Step 3.0: Generate forecasts for each site</a></li>
<li class="chapter" data-level="12.6" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-4-generate-metadata"><i class="fa fa-check"></i><b>12.6</b> Step 4: Generate metadata</a></li>
<li class="chapter" data-level="12.7" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#step-5-submit-forecast"><i class="fa fa-check"></i><b>12.7</b> Step 5: Submit forecast!</a></li>
<li class="chapter" data-level="12.8" data-path="example-forecast-workflow.html"><a href="example-forecast-workflow.html#example-on-github"><i class="fa fa-check"></i><b>12.8</b> Example on github</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="using-the-challenge-in-classes.html"><a href="using-the-challenge-in-classes.html"><i class="fa fa-check"></i><b>13</b> Using the Challenge in Classes</a></li>
<li class="chapter" data-level="14" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i><b>14</b> Frequently Asked Questions</a>
<ul>
<li class="chapter" data-level="14.1" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#my-model-uses-meterology-inputs.-where-can-i-find-forecasts-of-weather-to-use-in-my-ecological-forecast"><i class="fa fa-check"></i><b>14.1</b> My model uses meterology inputs. Where can I find forecasts of weather to use in my ecological forecast?</a></li>
<li class="chapter" data-level="14.2" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#i-need-historical-weather-data-to-build-my-model.-where-can-i-find-it"><i class="fa fa-check"></i><b>14.2</b> I need historical weather data to build my model. Where can I find it?</a></li>
<li class="chapter" data-level="14.3" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#i-submitted-my-forecast-but-cannot-find-it-on-the-dashboard-or-in-the-directory-of-forecasts"><i class="fa fa-check"></i><b>14.3</b> I submitted my forecast but cannot find it on the dashboard or in the directory of forecasts</a></li>
<li class="chapter" data-level="14.4" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#do-i-need-to-submit-forecasts-to-every-submission-date"><i class="fa fa-check"></i><b>14.4</b> Do I need to submit forecasts to every submission date?</a></li>
<li class="chapter" data-level="14.5" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#where-can-i-find-examples-of-forecasts-that-match-the-required-standard"><i class="fa fa-check"></i><b>14.5</b> Where can I find examples of forecasts that match the required standard?</a></li>
<li class="chapter" data-level="14.6" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#is-it-possible-to-automate-my-forecast-submissions"><i class="fa fa-check"></i><b>14.6</b> Is it possible to automate my forecast submissions?</a></li>
<li class="chapter" data-level="14.7" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#i-am-having-trouble-generating-the-metadata.-can-you-point-me-to-more-information-tutorials-or-examples"><i class="fa fa-check"></i><b>14.7</b> I am having trouble generating the metadata. Can you point me to more information, tutorials, or examples?</a></li>
<li class="chapter" data-level="14.8" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-many-years-are-you-planning-to-run-the-challenge"><i class="fa fa-check"></i><b>14.8</b> How many years are you planning to run the Challenge?</a></li>
<li class="chapter" data-level="14.9" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#are-there-certain-types-of-models-that-i-need-to-use"><i class="fa fa-check"></i><b>14.9</b> Are there certain types of models that I need to use?</a></li>
<li class="chapter" data-level="14.10" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#what-is-the-relationship-between-the-challenge-and-neon"><i class="fa fa-check"></i><b>14.10</b> What is the relationship between the Challenge and NEON?</a></li>
<li class="chapter" data-level="14.11" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#i-am-interested-in-submitting-different-models-or-to-multiple-themes.-how-should-i-register-to-do-this"><i class="fa fa-check"></i><b>14.11</b> I am interested in submitting different models or to multiple themes. How should I register to do this?</a></li>
<li class="chapter" data-level="14.12" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#where-can-i-find-resources-that-provide-how-to-participate-in-the-challenge"><i class="fa fa-check"></i><b>14.12</b> Where can I find resources that provide how to participate in the Challenge?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NEON Ecological Forecasting Challenge</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-forecast-workflow" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Example Forecast Workflow</h1>
<p>Here is an example of a complete workflow for generating a forecast submission to the Challenge. The example is for the aquatics theme and it forecasts water temperature and oxygen. The water temperature forecast uses a linear regression between air temperature and water temperature to predict water temperature in the future. It then uses the prediction of water temperature to predict oxygen water oxygen concentration by assuming that the oxygen is 100% saturated given the predicted temperature.</p>
<p>To generate the forecast we need to:
1) Build a relationship between past air temperature and past water temperature.<br />
2) Apply the relationships from #1 to forecasted air temperature.<br />
3) Calculate oxygen concentration from the forecasted water temperature.</p>
<p>Therefore we need to:
1) Download the historical water temperature data for the NEON sites (called “targets”).<br />
2) Download historical air temperature data for the NEON sites (we the stacked NOAA GEFS weather).<br />
3) Download NOAA weather forecast for the NEON sites.<br />
4) Create linear regression model based on historical data for each NEON site.<br />
5) Apply linear regression to using weather forecasts for each NEON.<br />
6) Write forecast output file.<br />
7) Correct metadata describing forecast.<br />
8) Submit forecast to Challenge.</p>
<p>Each of these steps are below</p>
<div id="step-0-set-up-r-environment-and-directories" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Step 0: Set up R environment and directories</h2>
<p>We will be downloading NOAA forecasts from the Challenge s3 bucket and submitting to the s3 bucket. Therefore the AWS information is needed.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="example-forecast-workflow.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
## ✔ tibble  3.1.6     ✔ dplyr   1.0.8
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="example-forecast-workflow.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neon4cast)</span>
<span id="cb84-2"><a href="example-forecast-workflow.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="example-forecast-workflow.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rMR)</span></code></pre></div>
<pre><code>## Loading required package: biglm</code></pre>
<pre><code>## Loading required package: DBI</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="example-forecast-workflow.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(EFIstandards)</span></span>
<span id="cb90-2"><a href="example-forecast-workflow.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="example-forecast-workflow.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="st">&quot;AWS_DEFAULT_REGION&quot;</span> <span class="ot">=</span> <span class="st">&quot;data&quot;</span>,</span>
<span id="cb90-4"><a href="example-forecast-workflow.html#cb90-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;AWS_S3_ENDPOINT&quot;</span> <span class="ot">=</span> <span class="st">&quot;ecoforecast.org&quot;</span>)</span>
<span id="cb90-5"><a href="example-forecast-workflow.html#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="example-forecast-workflow.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;drivers&quot;</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Define the date that the forecast starts. For demonstration purposes, we are setting the date to <code>2022-02-15</code>. In a real-time application, use <code>forecast_date &lt;- Sys.Date()</code></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="example-forecast-workflow.html#cb91-1" aria-hidden="true" tabindex="-1"></a>forecast_date <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(<span class="st">&quot;2022-02-15&quot;</span>)  </span></code></pre></div>
</div>
<div id="step-0-define-team-name-and-team-members" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> Step 0: Define team name and team members</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="example-forecast-workflow.html#cb92-1" aria-hidden="true" tabindex="-1"></a>team_name <span class="ot">&lt;-</span> <span class="st">&quot;air2waterSat&quot;</span></span>
<span id="cb92-2"><a href="example-forecast-workflow.html#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="example-forecast-workflow.html#cb92-3" aria-hidden="true" tabindex="-1"></a>team_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">individualName =</span> <span class="fu">list</span>(<span class="at">givenName =</span> <span class="st">&quot;Quinn&quot;</span>, </span>
<span id="cb92-4"><a href="example-forecast-workflow.html#cb92-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">surName =</span> <span class="st">&quot;Thomas&quot;</span>),</span>
<span id="cb92-5"><a href="example-forecast-workflow.html#cb92-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">organizationName =</span> <span class="st">&quot;Virginia Tech&quot;</span>,</span>
<span id="cb92-6"><a href="example-forecast-workflow.html#cb92-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">electronicMailAddress =</span> <span class="st">&quot;rqthomas@vt.edu&quot;</span>))</span></code></pre></div>
</div>
<div id="step-1-download-latest-target-data-and-site-description-data" class="section level2" number="12.3">
<h2><span class="header-section-number">12.3</span> Step 1: Download latest target data and site description data</h2>
<p>These targets are updated when new data is available from NEON.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="example-forecast-workflow.html#cb93-1" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://data.ecoforecast.org/targets/aquatics/aquatics-targets.csv.gz&quot;</span>, <span class="at">guess_max =</span> <span class="fl">1e6</span>)</span></code></pre></div>
<pre><code>## Rows: 9763 Columns: 10
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (1): siteID
## dbl  (8): oxygen, temperature, chla, oxygen_sd, temperature_sd, chla_sd, dep...
## date (1): time
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>A table is available with NEON site descriptions. The calculation of oxygen saturation requires the elevation of each site, which is included in the site description table.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="example-forecast-workflow.html#cb95-1" aria-hidden="true" tabindex="-1"></a>site_data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/eco4cast/neon4cast-aquatics/master/Aquatic_NEON_Field_Site_Metadata_20210928.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5 Columns: 46
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (22): field_domain_id, field_site_id, field_site_name, field_site_type, ...
## dbl (10): field_latitude, field_longitude, field_utm_northing, field_utm_eas...
## lgl (14): field_minimum_elevation_m, field_maximum_elevation_m, field_domina...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="step-2-get-drivers" class="section level2" number="12.4">
<h2><span class="header-section-number">12.4</span> Step 2: Get drivers</h2>
<div id="step-2.1-download-paste-noaa-forecast-stacked-together" class="section level3" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Step 2.1: Download Paste NOAA forecast stacked together</h3>
<p>To build the relations between air and water temperature, we need historical air temperature data to associate with historical water temperature data. Here we use a product that the Challenge organizers created that combines day 1 NOAA weather forecasts (i.e., when the forecasts are most accurate) together to generate an estimate of past weather. He we download this “stack” NOAA product for the set of NEON sites in the targets file.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="example-forecast-workflow.html#cb97-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(target<span class="sc">$</span>siteID)</span>
<span id="cb97-2"><a href="example-forecast-workflow.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)){</span>
<span id="cb97-3"><a href="example-forecast-workflow.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  neon4cast<span class="sc">::</span><span class="fu">get_stacked_noaa_s3</span>(<span class="st">&quot;.&quot;</span>,<span class="at">site =</span> sites[i], <span class="at">averaged =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-4"><a href="example-forecast-workflow.html#cb97-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2.2-download-noaa-future-forecast" class="section level3" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Step 2.2: Download NOAA future forecast</h3>
<p>We need NOAA Weather forecasts of the future. Fortunately, the Challenge organizers are downloading and subsetting the weather forecasts for each NEON site. Here we download the weather forecast (<code>date = forecast_date</code>) that started at mid-night UTC (<code>cycle=00</code>) for the set of sites in the target file.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="example-forecast-workflow.html#cb98-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">unique</span>(target<span class="sc">$</span>siteID)</span>
<span id="cb98-2"><a href="example-forecast-workflow.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)){</span>
<span id="cb98-3"><a href="example-forecast-workflow.html#cb98-3" aria-hidden="true" tabindex="-1"></a>  neon4cast<span class="sc">::</span><span class="fu">get_noaa_forecast_s3</span>(<span class="st">&quot;.&quot;</span>,<span class="at">model =</span> <span class="st">&quot;NOAAGEFS_1hr&quot;</span>, <span class="at">site =</span> sites[i], <span class="at">date =</span> forecast_date, <span class="at">cycle =</span> <span class="st">&quot;00&quot;</span>)</span>
<span id="cb98-4"><a href="example-forecast-workflow.html#cb98-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="step-2.3-create-data-frames-of-drivers" class="section level3" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> Step 2.3 Create data frames of drivers</h3>
<p>The NOAA stacked and forecast files are netcdf files. Here we convert to data frames to used in our analyses.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="example-forecast-workflow.html#cb99-1" aria-hidden="true" tabindex="-1"></a>noaa_past <span class="ot">&lt;-</span> neon4cast<span class="sc">::</span><span class="fu">stack_noaa</span>(<span class="at">dir =</span> <span class="st">&quot;drivers&quot;</span>, <span class="at">model =</span> <span class="st">&quot;NOAAGEFS_1hr_stacked&quot;</span>)</span>
<span id="cb99-2"><a href="example-forecast-workflow.html#cb99-2" aria-hidden="true" tabindex="-1"></a>noaa_future <span class="ot">&lt;-</span> neon4cast<span class="sc">::</span><span class="fu">stack_noaa</span>(<span class="at">dir =</span> <span class="st">&quot;drivers&quot;</span>, <span class="at">model =</span> <span class="st">&quot;NOAAGEFS_1hr&quot;</span>, <span class="at">forecast_date =</span> forecast_date)</span></code></pre></div>
</div>
<div id="step-2.4-aggregate-to-day-and-convert-units-of-drivers" class="section level3" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> Step 2.4 Aggregate (to day) and convert units of drivers</h3>
<p>Since we are forecasting daily mean water temperature and oxygen, we need to aggregate the 1 hr weather data to the daily time-scale. We also need to convert from Kelvin to Celsius.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="example-forecast-workflow.html#cb100-1" aria-hidden="true" tabindex="-1"></a>noaa_past_mean <span class="ot">&lt;-</span> noaa_past <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="example-forecast-workflow.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href="example-forecast-workflow.html#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb100-4"><a href="example-forecast-workflow.html#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">air_temperature =</span> <span class="fu">mean</span>(air_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb100-5"><a href="example-forecast-workflow.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">time =</span> date) <span class="sc">%&gt;%</span> </span>
<span id="cb100-6"><a href="example-forecast-workflow.html#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">air_temperature =</span> air_temperature <span class="sc">-</span> <span class="fl">273.15</span>)</span></code></pre></div>
<p>For the future weather has 31 ensemble members (i.e., different trajectories of weather), that we want to use to generate uncertainty in our water temperature and oxygen forecasts. The aggregation below maintains the separate ensemble members (<code>group_by(date, ensemble)</code>).</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="example-forecast-workflow.html#cb101-1" aria-hidden="true" tabindex="-1"></a>noaa_future_mean <span class="ot">&lt;-</span> noaa_future <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="example-forecast-workflow.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as_date</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="example-forecast-workflow.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, ensemble) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="example-forecast-workflow.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">air_temperature =</span> <span class="fu">mean</span>(air_temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-5"><a href="example-forecast-workflow.html#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">time =</span> date) <span class="sc">%&gt;%</span> </span>
<span id="cb101-6"><a href="example-forecast-workflow.html#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ensemble =</span> <span class="fu">as.numeric</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(ensemble, <span class="at">start =</span> <span class="dv">4</span>, <span class="at">end =</span> <span class="dv">6</span>)),</span>
<span id="cb101-7"><a href="example-forecast-workflow.html#cb101-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">air_temperature =</span> air_temperature <span class="sc">-</span> <span class="fl">273.15</span>)</span></code></pre></div>
</div>
<div id="step-2.5-merge-in-past-noaa-data-into-the-targets-file-matching-by-date." class="section level3" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> Step 2.5: Merge in past NOAA data into the targets file, matching by date.</h3>
<p>Before building our linear model we need merge in the historical air temperature to match with the historical water temperature</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="example-forecast-workflow.html#cb102-1" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fu">left_join</span>(target, noaa_past_mean, <span class="at">by =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="step-3.0-generate-forecasts-for-each-site" class="section level2" number="12.5">
<h2><span class="header-section-number">12.5</span> Step 3.0: Generate forecasts for each site</h2>
<p>We generate a forecast for each site.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="example-forecast-workflow.html#cb103-1" aria-hidden="true" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb103-2"><a href="example-forecast-workflow.html#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="example-forecast-workflow.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)){</span>
<span id="cb103-4"><a href="example-forecast-workflow.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-5"><a href="example-forecast-workflow.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get site information for elevation</span></span>
<span id="cb103-6"><a href="example-forecast-workflow.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  site_info <span class="ot">&lt;-</span> site_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(field_site_id <span class="sc">==</span> sites[i]) </span>
<span id="cb103-7"><a href="example-forecast-workflow.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-8"><a href="example-forecast-workflow.html#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Fit linear model based on past data: water temperature = m * air temperature + b</span></span>
<span id="cb103-9"><a href="example-forecast-workflow.html#cb103-9" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(target<span class="sc">$</span>temperature<span class="sc">~</span>target<span class="sc">$</span>air_temperature)</span>
<span id="cb103-10"><a href="example-forecast-workflow.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-11"><a href="example-forecast-workflow.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use linear regression to forecast water temperature for each ensemble member</span></span>
<span id="cb103-12"><a href="example-forecast-workflow.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  forecasted_temperature <span class="ot">&lt;-</span> fit<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> fit<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="sc">*</span> noaa_future_mean<span class="sc">$</span>air_temperature</span>
<span id="cb103-13"><a href="example-forecast-workflow.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="example-forecast-workflow.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#use forecasted temperature to predict oxygen by assuming that oxygen is saturated.  </span></span>
<span id="cb103-15"><a href="example-forecast-workflow.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  forecasted_oxygen <span class="ot">&lt;-</span> rMR<span class="sc">::</span><span class="fu">Eq.Ox.conc</span>(forecasted_temperature, <span class="at">elevation.m =</span> ,site_info<span class="sc">$</span>field_mean_elevation_m, </span>
<span id="cb103-16"><a href="example-forecast-workflow.html#cb103-16" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">bar.press =</span> <span class="cn">NULL</span>, </span>
<span id="cb103-17"><a href="example-forecast-workflow.html#cb103-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">bar.units =</span> <span class="cn">NULL</span>,</span>
<span id="cb103-18"><a href="example-forecast-workflow.html#cb103-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">out.DO.meas =</span> <span class="st">&quot;mg/L&quot;</span>,</span>
<span id="cb103-19"><a href="example-forecast-workflow.html#cb103-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">salinity =</span> <span class="dv">0</span>, </span>
<span id="cb103-20"><a href="example-forecast-workflow.html#cb103-20" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">salinity.units =</span> <span class="st">&quot;pp.thou&quot;</span>)</span>
<span id="cb103-21"><a href="example-forecast-workflow.html#cb103-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-22"><a href="example-forecast-workflow.html#cb103-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Build site level dataframe.  Note we are not forecasting chla</span></span>
<span id="cb103-23"><a href="example-forecast-workflow.html#cb103-23" aria-hidden="true" tabindex="-1"></a>  site_forecast <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">time =</span> noaa_future_mean<span class="sc">$</span>time,</span>
<span id="cb103-24"><a href="example-forecast-workflow.html#cb103-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">siteID =</span> sites[i],</span>
<span id="cb103-25"><a href="example-forecast-workflow.html#cb103-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ensemble =</span> noaa_future_mean<span class="sc">$</span>ensemble,</span>
<span id="cb103-26"><a href="example-forecast-workflow.html#cb103-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">forecast =</span> <span class="dv">1</span>,</span>
<span id="cb103-27"><a href="example-forecast-workflow.html#cb103-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">temperature =</span> forecasted_temperature,</span>
<span id="cb103-28"><a href="example-forecast-workflow.html#cb103-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">oxygen =</span> forecasted_oxygen,</span>
<span id="cb103-29"><a href="example-forecast-workflow.html#cb103-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">chla =</span> <span class="cn">NA</span>)</span>
<span id="cb103-30"><a href="example-forecast-workflow.html#cb103-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Bind with other sites</span></span>
<span id="cb103-31"><a href="example-forecast-workflow.html#cb103-31" aria-hidden="true" tabindex="-1"></a>  forecast <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(forecast, site_forecast)</span>
<span id="cb103-32"><a href="example-forecast-workflow.html#cb103-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Use ggplot to visualize the forecast for each variable and site. The spread in forecast is due to uncertainty in the weather forecast, where each line is associated with a different NOAA GEFS weather forecast ensemble member.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="example-forecast-workflow.html#cb104-1" aria-hidden="true" tabindex="-1"></a>forecast <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="example-forecast-workflow.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>chla) <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="example-forecast-workflow.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;temperature&quot;</span>,<span class="st">&quot;oxygen&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;values&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="example-forecast-workflow.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> values, <span class="at">group =</span> ensemble)) <span class="sc">+</span></span>
<span id="cb104-5"><a href="example-forecast-workflow.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb104-6"><a href="example-forecast-workflow.html#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(variable<span class="sc">~</span>siteID, <span class="at">scale =</span><span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="04-WorkflowExample_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Forecast output file name in standards requires for Challenge. “csv.gz” means that it will be compressed</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="example-forecast-workflow.html#cb105-1" aria-hidden="true" tabindex="-1"></a>forecast_file <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;aquatics&quot;</span>,<span class="st">&quot;-&quot;</span>,<span class="fu">min</span>(forecast<span class="sc">$</span>time),<span class="st">&quot;-&quot;</span>,team_name,<span class="st">&quot;.csv.gz&quot;</span>)</span></code></pre></div>
<p>Write csv to disk</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="example-forecast-workflow.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(forecast, forecast_file)</span></code></pre></div>
<p>Confirm that output file meets standard for Challenge</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="example-forecast-workflow.html#cb107-1" aria-hidden="true" tabindex="-1"></a>neon4cast<span class="sc">::</span><span class="fu">forecast_output_validator</span>(forecast_file)</span></code></pre></div>
</div>
<div id="step-4-generate-metadata" class="section level2" number="12.6">
<h2><span class="header-section-number">12.6</span> Step 4: Generate metadata</h2>
<p>First we need to create a “list” in R that describes the forecast model. We only have one source of uncertainty (driver). It is propagated (i.e., represented in the forecasted output) using 31 ensemble members.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="example-forecast-workflow.html#cb108-1" aria-hidden="true" tabindex="-1"></a>model_metadata <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb108-2"><a href="example-forecast-workflow.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">forecast =</span> <span class="fu">list</span>(</span>
<span id="cb108-3"><a href="example-forecast-workflow.html#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_description =</span> <span class="fu">list</span>(</span>
<span id="cb108-4"><a href="example-forecast-workflow.html#cb108-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">forecast_model_id =</span>  <span class="st">&quot;air2waterSat&quot;</span>,  <span class="co">#What goes here</span></span>
<span id="cb108-5"><a href="example-forecast-workflow.html#cb108-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">&quot;Air temperature to water temperature linear regression plus assume saturated oxygen&quot;</span>, </span>
<span id="cb108-6"><a href="example-forecast-workflow.html#cb108-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">&quot;empirical&quot;</span>,  </span>
<span id="cb108-7"><a href="example-forecast-workflow.html#cb108-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">repository =</span> <span class="st">&quot;https://github.com/rqthomas/neon4cast-example&quot;</span> </span>
<span id="cb108-8"><a href="example-forecast-workflow.html#cb108-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-9"><a href="example-forecast-workflow.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">initial_conditions =</span> <span class="fu">list</span>(</span>
<span id="cb108-10"><a href="example-forecast-workflow.html#cb108-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;absent&quot;</span></span>
<span id="cb108-11"><a href="example-forecast-workflow.html#cb108-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-12"><a href="example-forecast-workflow.html#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">drivers =</span> <span class="fu">list</span>(</span>
<span id="cb108-13"><a href="example-forecast-workflow.html#cb108-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;propagates&quot;</span>,</span>
<span id="cb108-14"><a href="example-forecast-workflow.html#cb108-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">complexity =</span> <span class="dv">1</span>, <span class="co">#Just temperature</span></span>
<span id="cb108-15"><a href="example-forecast-workflow.html#cb108-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">propagation =</span> <span class="fu">list</span>( </span>
<span id="cb108-16"><a href="example-forecast-workflow.html#cb108-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;ensemble&quot;</span>, </span>
<span id="cb108-17"><a href="example-forecast-workflow.html#cb108-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">31</span>) </span>
<span id="cb108-18"><a href="example-forecast-workflow.html#cb108-18" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-19"><a href="example-forecast-workflow.html#cb108-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb108-20"><a href="example-forecast-workflow.html#cb108-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;absent&quot;</span></span>
<span id="cb108-21"><a href="example-forecast-workflow.html#cb108-21" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-22"><a href="example-forecast-workflow.html#cb108-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">random_effects =</span> <span class="fu">list</span>(</span>
<span id="cb108-23"><a href="example-forecast-workflow.html#cb108-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;absent&quot;</span></span>
<span id="cb108-24"><a href="example-forecast-workflow.html#cb108-24" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-25"><a href="example-forecast-workflow.html#cb108-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">process_error =</span> <span class="fu">list</span>(</span>
<span id="cb108-26"><a href="example-forecast-workflow.html#cb108-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;absent&quot;</span></span>
<span id="cb108-27"><a href="example-forecast-workflow.html#cb108-27" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb108-28"><a href="example-forecast-workflow.html#cb108-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">obs_error =</span> <span class="fu">list</span>(</span>
<span id="cb108-29"><a href="example-forecast-workflow.html#cb108-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">status =</span> <span class="st">&quot;absent&quot;</span></span>
<span id="cb108-30"><a href="example-forecast-workflow.html#cb108-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb108-31"><a href="example-forecast-workflow.html#cb108-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-32"><a href="example-forecast-workflow.html#cb108-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Using the <code>team_list</code> and <code>model_metadata</code> above, we can create the metadata file. The function <code>neon4cast::generate_metadata</code> adds additional information to complete the metadata (i.e., geographic information about the site, etc.)</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="example-forecast-workflow.html#cb109-1" aria-hidden="true" tabindex="-1"></a>metadata_file <span class="ot">&lt;-</span> neon4cast<span class="sc">::</span><span class="fu">generate_metadata</span>(forecast_file, team_list, model_metadata)</span></code></pre></div>
</div>
<div id="step-5-submit-forecast" class="section level2" number="12.7">
<h2><span class="header-section-number">12.7</span> Step 5: Submit forecast!</h2>
<p>Now we can submit the forecast output and the metadata file to the Challenge using the <code>neon4cast::submit()</code> function</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="example-forecast-workflow.html#cb110-1" aria-hidden="true" tabindex="-1"></a>neon4cast<span class="sc">::</span><span class="fu">submit</span>(<span class="at">forecast_file =</span> forecast_file,</span>
<span id="cb110-2"><a href="example-forecast-workflow.html#cb110-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metadata =</span> metadata_file,</span>
<span id="cb110-3"><a href="example-forecast-workflow.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>You can check on the status of your submission using</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="example-forecast-workflow.html#cb111-1" aria-hidden="true" tabindex="-1"></a>neon4cast<span class="sc">::</span><span class="fu">check_submission</span>(forecast_file)</span></code></pre></div>
<p>On following day after submission, you can see the forecast on the dashboard at <a href="https://shiny.ecoforecast.org">shiny.ecoforecast.org</a></p>
</div>
<div id="example-on-github" class="section level2" number="12.8">
<h2><span class="header-section-number">12.8</span> Example on github</h2>
<p>The example code above can be found on GitHub as a template repository at [<a href="https://github.com/eco4cast/neon4cast-example.git" class="uri">https://github.com/eco4cast/neon4cast-example.git</a>]. See the Readme for more information about using the template</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="helpful-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-the-challenge-in-classes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
